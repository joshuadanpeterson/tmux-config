# .tmux.conf

# Set prefix to Ctrl + Space
unbind C-b
set -g prefix C-Space
bind C-Space send-prefix

# Set colors
set-option -sa terminal-overrides ",xterm*:Tc"

# Vi-style pane selection
bind -r k select-pane -U
bind -r j select-pane -D
bind -r h select-pane -L
bind -r l select-pane -R

# Cycle through windows
bind -n M-H previous-window
bind -n M-L next-window

# Enable vi mode-keys for copy mode
setw -g mode-keys vi

# Improved pane splitting commands
bind | split-window -h
bind - split-window -v
unbind '"'
unbind %

# Start windows and panes at 1, not 0
set -g base-index 1
set -g pane-base-index 1
set-window-option -g pane-base-index 1
set-option -g renumber-windows on

# Set mouse resizing
set-option -g mouse on

# Reload tmux config
unbind r
bind r source-file ~/.config/tmux/.tmux.conf

# Clipboard integration for macOS (requires reattach-to-user-namespace)
bind -T copy-mode-vi v send -X begin-selection
bind -T copy-mode-vi y send-keys -X copy-pipe-and-cancel "pbcopy"
bind-key -T copy-mode-vi C-v send-keys -X rectangle-toggled
bind P paste-buffer
bind -T copy-mode-vi MouseDragEnd1Pane send-keys -X copy-pipe-and-cancel "pbcopy"

# Improved Statusbar Info
# Bind key to display pane numbers for a short duration
bind-key q display-panes

# # Merge statusbars with vim-tpipeline
set -g focus-events on
set -g status-style bg=default
set -g status-left-length 90
set -g status-right-length 90
set -g status-justify centre
set -g default-terminal "xterm-256color"

# Set color consistency
# set -s default-terminal tmux-256color
# set -as terminal-overrides ",*:Tc"

# Custom command to reset status line
bind R set-option -g status-right "Your default status-right config" \; set-option -g status-left "Your default status-left config"

# Reset status line when leaving a pane
# set-hook -g pane-focus-out 'set-option -g status-right "Your default status-right config"'
# set-hook -g pane-focus-in 'set-option -g status-right "Your custom status-right config when in Neovim"'

# Load plugins
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'tmux-plugins/resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'
set -g @plugin 'tmux-plugins/tmux-pain-control'
set -g @plugin 'tmux-plugins/tmux-logging'
set -g @plugin 'tmux-plugins/tmux-yank'
set -g @plugin 'imomaliev/tmux-keyboard-layout'

# Load themes  
# set -g @plugin 'fabioluciano/tmux-tokyo-night'
set -g @plugin "nordtheme/tmux"
set -g @plugin 'erikw/tmux-powerline'

# Initialize and set Treemux:
set -g @treemux-tree-nvim-init-file '~/.tmux/plugins/treemux/configs/treemux_init.lua'
set -g @plugin 'kiyoon/treemux'
# Set refresh rate
set -g @treemux-refresh-interval 0.1			# the focus is on the main pane or the side Nvim-Tree.
set -g @treemux-refresh-interval-inactive-pane 1		# the focus is not on the pane but you're still in the same window.
set -g @treemux-refresh-interval-inactive-window 3		# you left the window.
# Set sidebar position
set -g @treemux-tree-position 'left'

# Initialize Vim Tmux Navigator
set -g @plugin 'christoomey/vim-tmux-navigator'

# Load Tmux Plugin Manager (TPM)
# Initialize TPM (ensure this is at the end of tmux.conf)
if "test ! -d ~/.tmux/plugins/tpm" \
   "run 'git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm && ~/.tmux/plugins/tpm/bin/install_plugins'"

run '~/.tmux/plugins/tpm/tpm'

